    <!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <title>Pixel City Architect</title>
    <style>
        /* 8-BIT STIL DEFINISJONER */
        :root {
            --pixel: 4px;
            --grid-size: 100px;
            --bg-color: #3e8948; /* Mørkegrønn plen */
        }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background: #222;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
            color: white;
            image-rendering: pixelated;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        /* KARTET OVENFRA */
        #city-grid {
            position: relative;
            display: grid;
            gap: 4px;
            padding: 10px;
            background: #333;
            border: 8px solid #111;
            transition: all 0.5s ease;
        }

        .slot {
            width: var(--grid-size);
            height: var(--grid-size);
            background: var(--bg-color);
            position: relative;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* PIXEL ART ELEMENTER (TEGNET MED CSS) */
        .asset {
            position: absolute;
            width: 100%;
            height: 100%;
            animation: buildScale 0.2s steps(4);
        }

        .house { background: #8b4513; border: 15px solid #a0522d; box-sizing: border-box; } /* Tak sett ovenfra */
        .road { background: #444; border: 2px dashed #666; }
        .garden { background: #a2d149; border: 5px solid #8ebf37; }
        .tree { background: #2d5a24; border-radius: 50%; width: 40px; height: 40px; margin: 30px; border: 4px solid #1e3d18; }
        .school { background: #b22222; border: 10px double #fff; }
        .mall { background: #555; border: 15px solid #777; }

        /* UI - MINECRAFT STIL */
        .ui-box {
            position: absolute;
            background: #c6c6c6;
            border: 4px solid #ffffff;
            border-right-color: #555;
            border-bottom-color: #555;
            padding: 10px;
            color: #333;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
            z-index: 100;
        }

        #money-display {
            top: 20px;
            left: 20px;
            font-size: 24px;
            font-weight: bold;
        }

        #shop {
            top: 20px;
            right: 20px;
            width: 250px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .shop-btn {
            background: #8b8b8b;
            border: 2px solid #ffffff;
            border-right-color: #555;
            border-bottom-color: #555;
            margin: 5px 0;
            padding: 8px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
        }

        .shop-btn:hover:not(.disabled) { background: #9b9b9b; }
        .shop-btn.disabled { opacity: 0.5; cursor: not-allowed; background: #555; color: #888; }

        /* PENGE ANIMASJON */
        .money-fx {
            position: absolute;
            width: 24px; height: 24px;
            background: #ffd700;
            border: 3px solid #b8860b;
            border-radius: 50%;
            pointer-events: none;
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(400px) rotate(360deg); opacity: 0; }
        }

        @keyframes buildScale {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="money-display" class="ui-box">
        COINS: <span id="coins">0</span>
    </div>

    <div id="shop" class="ui-box">
        <div style="text-align:center; font-weight:bold; border-bottom:2px solid #555; margin-bottom:5px;">BUTIKK</div>
        <div id="item-list"></div>
    </div>

    <div id="city-grid"></div>
</div>

<script>
    let state = {
        coins: 0,
        totalSpent: 0,
        clickCount: 0,
        coinsPerClick: 5,
        billValue: 10,
        unlockedTiers: 1,
        builtCount: 0
    };

    // Definisjon av kart-layout (Pre-definert rekkefølge ting bygges på)
    // Vi fyller kartet innenfra og ut
    const buildOrder = [
        { type: 'road', pos: [1,1] }, { type: 'house', pos: [0,0] }, { type: 'garden', pos: [0,1] }, { type: 'tree', pos: [1,0] }, // Start 2x2
        { type: 'road', pos: [1,2] }, { type: 'road', pos: [2,1] }, { type: 'house', pos: [2,2] }, { type: 'tree', pos: [2,0] }, // Utvidelse 1
        { type: 'road', pos: [0,2] }, { type: 'garden', pos: [1,2] }, { type: 'school', pos: [2,3] } // Osv.
    ];

    const catalog = {
        hage: { name: "Hage", cost: 10, bonus: 1, class: 'garden', limit: 10 },
        tre: { name: "Tre", cost: 15, bonus: 1, class: 'tree', limit: 15 },
        vei: { name: "Vei", cost: 20, bonus: 2, class: 'road', limit: 20 },
        hus: { name: "Hus", cost: 200, bonus: 10, class: 'house', limit: 8 },
        skole: { name: "Skole", cost: 300, bonus: 15, class: 'school', unlock: 400, limit: 2 },
        senter: { name: "Senter", cost: 500, bonus: 20, class: 'mall', unlock: 800, limit: 1 },
        sykehus: { name: "Sykehus", cost: 1200, bonus: 50, class: 'hospital', unlock: 2000, limit: 1 }
    };

    const inventory = { hage:0, tre:0, vei:0, hus:0, skole:0, senter:0, sykehus:0 };

    function initGrid() {
        const grid = document.getElementById('city-grid');
        grid.style.gridTemplateColumns = `repeat(2, var(--grid-size))`;
        for(let i=0; i<4; i++) {
            let slot = document.createElement('div');
            slot.className = 'slot';
            slot.id = `slot-${i}`;
            grid.appendChild(slot);
        }
    }

    // Klikk-håndtering med "My Code Arcade" stil animasjon
    document.getElementById('game-container').addEventListener('mousedown', (e) => {
        if(e.target.closest('.ui-box')) return;
        
        state.clickCount++;
        let isBill = state.clickCount % 5 === 0;
        let amount = isBill ? 1 : 5;
        let val = isBill ? state.billValue : 1;

        for(let i=0; i<amount; i++) {
            createMoneyAnim(e.clientX, e.clientY, isBill);
        }
        
        state.coins += (amount * val);
        updateUI();
    });

    function createMoneyAnim(x, y, isBill) {
        const m = document.createElement('div');
        m.className = 'money-fx';
        if(isBill) {
            m.style.background = '#85bb65';
            m.style.width = '40px';
            m.style.borderRadius = '2px';
            m.innerText = state.billValue;
        }
        m.style.left = (x + (Math.random()*40-20)) + 'px';
        m.style.top = y + 'px';
        m.style.animation = `fall ${1 + Math.random()}s Math.ease-in forwards`;
        
        document.body.appendChild(m);
        setTimeout(() => m.remove(), 2000);
    }

    function updateUI() {
        document.getElementById('coins').innerText = Math.floor(state.coins);
        const list = document.getElementById('item-list');
        list.innerHTML = '';

        for(let key in catalog) {
            const item = catalog[key];
            const unlocked = !item.unlock || state.totalSpent >= item.unlock;
            const soldOut = inventory[key] >= item.limit;

            if(unlocked) {
                const btn = document.createElement('div');
                btn.className = `shop-btn ${state.coins < item.cost || soldOut ? 'disabled' : ''}`;
                btn.innerHTML = `<span>${item.name} ${soldOut ? '(UTSOLGT)' : ''}</span> <span>${item.cost}c</span>`;
                if(!soldOut) btn.onclick = () => buyItem(key);
                list.appendChild(btn);
            }
        }
        
        // Utvid grid hvis nødvendig
        if(state.builtCount >= 4 && state.unlockedTiers === 1) expandGrid(4);
    }

    function buyItem(key) {
        const item = catalog[key];
        if(state.coins >= item.cost) {
            state.coins -= item.cost;
            state.totalSpent += item.cost;
            inventory[key]++;
            state.builtCount++;
            
            // Øk priser og verdier
            state.coinsPerClick += item.bonus;
            state.billValue += 2;
            item.cost = Math.floor(item.cost * 1.2); 

            placeInGrid(item.class);
            updateUI();
        }
    }

    function placeInGrid(className) {
        const slots = document.querySelectorAll('.slot:not(.occupied)');
        if(slots.length > 0) {
            const target = slots[0];
            const asset = document.createElement('div');
            asset.className = `asset ${className}`;
            target.appendChild(asset);
            target.classList.add('occupied');
        }
    }

    function expandGrid(size) {
        state.unlockedTiers++;
        const grid = document.getElementById('city-grid');
        grid.style.gridTemplateColumns = `repeat(${Math.sqrt(grid.children.length + size)}, var(--grid-size))`;
        for(let i=0; i<size; i++) {
            let slot = document.createElement('div');
            slot.className = 'slot';
            grid.appendChild(slot);
        }
    }

    initGrid();
    updateUI();
</script>
</body>
</html>
